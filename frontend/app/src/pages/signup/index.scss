/**
 * 报名页面 - 弹窗式卡片设计
 * 设计参考: 小程序端设计/立即报名-*.png
 * 重构时间: 2026年1月6日
 */

// ============================================================
// 设计令牌
// ============================================================

// 浅色主题
$light-overlay: rgba(30, 90, 60, 0.08);
$light-card: #ffffff;
$light-text-primary: #1a1a1a;
$light-text-secondary: #6b7280;
$light-border: rgba(0, 0, 0, 0.06);

// 深色主题
$dark-overlay: rgba(0, 0, 0, 0.85);
$dark-card: #1c1c1e;
$dark-text-primary: #f5f5f7;
$dark-text-secondary: #8e8e93;
$dark-border: rgba(255, 255, 255, 0.1);

// 品牌色
$primary-green: #1E5A3C;
$primary-orange: #ff8a1a;
$primary-gradient: linear-gradient(135deg, #1E5A3C 0%, #2d7a52 100%);
$orange-gradient: linear-gradient(135deg, #ff9a3c 0%, #ff7d2b 100%);

// 圆角
$radius-sm: 12rpx;
$radius-md: 20rpx;
$radius-lg: 32rpx;
$radius-xl: 40rpx;

// ============================================================
// 页面容器
// ============================================================

.signup-page {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  position: relative;
  overflow: hidden;

  // 浅色主题背景 - 模拟弹窗遮罩
  &.theme-light {
    background: linear-gradient(
      180deg,
      rgba(236, 240, 236, 0.98) 0%,
      rgba(232, 238, 234, 0.95) 100%
    );
  }

  // 深色主题背景
  &.theme-dark {
    background: linear-gradient(
      180deg,
      rgba(10, 10, 12, 0.98) 0%,
      rgba(15, 15, 18, 0.95) 100%
    );
  }

  // 加载状态
  &.loading {
    justify-content: center;
    align-items: center;

    .loading-text {
      font-size: 28rpx;
      color: $light-text-secondary;
    }
  }
}

// 状态栏占位
.status-bar {
  width: 100%;
  flex-shrink: 0;
}

// ============================================================
// 弹窗式主卡片
// ============================================================

.modal-card {
  flex: 1;
  display: flex;
  flex-direction: column;
  margin: 48rpx; // 四周边距
  margin-top: 120rpx; // 大幅增加顶部间距，避免与胶囊重合
  margin-bottom: 48rpx; // 底部间距
  border-radius: $radius-xl;
  overflow: hidden;
  position: relative;
  max-height: calc(100vh - 240rpx); // 相应限制最大高度

  // 浅色主题卡片
  .theme-light & {
    background: $light-card;
    box-shadow:
      0 4rpx 20rpx rgba(0, 0, 0, 0.03),
      0 12rpx 40rpx rgba(0, 0, 0, 0.06),
      0 24rpx 80rpx rgba(30, 90, 60, 0.08);
  }

  // 深色主题卡片
  .theme-dark & {
    background: $dark-card;
    border: 1rpx solid $dark-border;
    box-shadow:
      0 8rpx 32rpx rgba(0, 0, 0, 0.4),
      0 24rpx 80rpx rgba(0, 0, 0, 0.5);
  }
}

// ============================================================
// 卡片头部
// ============================================================

.card-header {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  padding: 56rpx 36rpx 24rpx; // 增加顶部内边距
  flex-shrink: 0;
}

.card-header-info {
  flex: 1;
  display: flex;
  flex-direction: column;
  gap: 8rpx;
}

.card-title {
  font-size: 38rpx;
  font-weight: 700;
  letter-spacing: -0.02em;

  .theme-light & {
    color: $light-text-primary;
  }

  .theme-dark & {
    color: $dark-text-primary;
  }
}

.card-subtitle {
  font-size: 26rpx;
  font-weight: 400;

  .theme-light & {
    color: $light-text-secondary;
  }

  .theme-dark & {
    color: $dark-text-secondary;
  }
}

// 关闭按钮 - 在卡片内部右上角
.card-close {
  width: 64rpx;
  height: 64rpx;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  margin-top: -4rpx;
  margin-right: -8rpx;
  transition: all 0.2s ease;

  .theme-light & {
    background: rgba(0, 0, 0, 0.04);

    &:active {
      background: rgba(0, 0, 0, 0.08);
      transform: scale(0.95);
    }
  }

  .theme-dark & {
    background: rgba(255, 255, 255, 0.08);

    &:active {
      background: rgba(255, 255, 255, 0.12);
      transform: scale(0.95);
    }
  }

  .close-icon {
    width: 28rpx;
    height: 28rpx;

    .theme-light & {
      opacity: 0.6;
    }

    .theme-dark & {
      filter: invert(1);
      opacity: 0.7;
    }
  }
}

// ============================================================
// 步骤指示器区域
// ============================================================

.step-section {
  padding: 0 36rpx 16rpx;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 16rpx; // 缩小步骤器与标题的间距
  flex-shrink: 0;
}

.step-title {
  font-size: 32rpx;
  font-weight: 600;
  text-align: center;

  .theme-light & {
    color: $light-text-primary;
  }

  .theme-dark & {
    color: $dark-text-primary;
  }
}

// ============================================================
// 表单滚动区域
// ============================================================

.form-scroll {
  flex: 1;
  min-height: 0; // 关键：允许 flex 子元素收缩
  position: relative; // 添加定位上下文
  z-index: 1; // 确保低于按钮层级
  pointer-events: auto; // 允许滚动
}

.form-content {
  padding: 0 36rpx 420rpx; // 底部留足空间，避免第4步返程信息与底部按钮重叠
  pointer-events: auto; // 确保表单内容可交互
}

// ============================================================
// 底部操作按钮
// ============================================================

.card-actions {
  display: flex;
  gap: 12rpx; // 减小按钮间距
  padding: 16rpx 24rpx calc(24rpx + env(safe-area-inset-bottom)); // 兼容底部安全区
  flex-shrink: 0;
  position: relative; // 添加定位上下文
  z-index: 100; // 确保按钮在最上层
  pointer-events: auto; // 确保可以接收点击事件

  .theme-light & {
    background: transparent;
  }

  .theme-dark & {
    background: transparent;
    box-shadow: none;
  }
}

.action-button {
  flex: 1;
  height: 88rpx; // 稍微减小高度
  border-radius: 999rpx;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8rpx;
  font-size: 28rpx; // 稍微减小字体
  font-weight: 600;
  transition: all 0.2s ease;
  white-space: nowrap; // 防止文字换行
  min-width: 0; // 允许flex收缩

  &:active {
    transform: scale(0.98);
  }

  .btn-icon {
    width: 28rpx;
    height: 28rpx;
    flex-shrink: 0;
  }

  .btn-text {
    font-size: 28rpx;
    font-weight: 600;
    white-space: nowrap; // 防止文字换行
  }

  // 主按钮 - 深绿渐变
  &.primary {
    background: $primary-gradient;
    box-shadow: 0 8rpx 24rpx rgba(30, 90, 60, 0.3);

    .btn-text {
      color: #ffffff !important;
    }

    .btn-icon {
      filter: brightness(0) invert(1);
    }

    &:active {
      box-shadow: 0 4rpx 12rpx rgba(30, 90, 60, 0.4);
    }

    &.full {
      flex: 1;
    }
  }

  // 次要按钮 - 上一步
  &.secondary {
    .theme-light & {
      background: rgba(30, 90, 60, 0.08);

      .btn-text {
        color: $primary-green !important;
      }

      .btn-icon {
        filter: invert(27%) sepia(15%) saturate(1500%) hue-rotate(100deg) brightness(95%) contrast(90%);
      }
    }

    .theme-dark & {
      background: rgba(255, 255, 255, 0.1);

      .btn-text {
        color: #ffffff !important;
      }

      .btn-icon {
        filter: invert(1);
      }
    }
  }

  // 轮廓按钮 - 稍后填写
  &.outline {
    background: transparent;

    .theme-light & {
      border: 2rpx dashed rgba(0, 0, 0, 0.2);

      .btn-text {
        color: $light-text-secondary !important;
      }
    }

    .theme-dark & {
      border: 2rpx dashed rgba(255, 255, 255, 0.2);

      .btn-text {
        color: $dark-text-secondary !important;
      }
    }
  }

  // 加载状态
  &.loading {
    opacity: 0.7;
    pointer-events: none;
  }
}

// ============================================================
// 表单组件样式覆盖（确保与弹窗风格一致）
// ============================================================

// 表单字段标签
.form-label,
.field-label {
  font-size: 28rpx;
  font-weight: 500;
  margin-bottom: 16rpx;

  .theme-light & {
    color: $light-text-primary;
  }

  .theme-dark & {
    color: $dark-text-primary;
  }
}

// 必填标记
.required-mark {
  color: #e53935;
  margin-left: 4rpx;
}

// 输入框
.form-input,
input {
  height: 96rpx;
  border-radius: $radius-md;
  padding: 0 24rpx;
  font-size: 30rpx;
  transition: all 0.2s ease;

  .theme-light & {
    background: #f8f9fa;
    border: 2rpx solid transparent;
    color: $light-text-primary;

    &:focus {
      background: #ffffff;
      border-color: $primary-green;
      box-shadow: 0 0 0 4rpx rgba(30, 90, 60, 0.1);
    }

    &::placeholder {
      color: #9ca3af;
    }
  }

  .theme-dark & {
    background: rgba(255, 255, 255, 0.06);
    border: 2rpx solid transparent;
    color: $dark-text-primary;

    &:focus {
      background: rgba(255, 255, 255, 0.1);
      border-color: rgba(255, 255, 255, 0.3);
    }

    &::placeholder {
      color: #6b7280;
    }
  }
}

// 选择器
.form-select,
.picker {
  height: 96rpx;
  border-radius: $radius-md;
  padding: 0 24rpx;
  font-size: 30rpx;
  display: flex;
  align-items: center;
  justify-content: space-between;

  .theme-light & {
    background: #f8f9fa;
    border: 2rpx solid transparent;
    color: $light-text-primary;
  }

  .theme-dark & {
    background: rgba(255, 255, 255, 0.06);
    border: 2rpx solid transparent;
    color: $dark-text-primary;
  }
}

// 单选按钮组
.radio-group {
  display: flex;
  gap: 24rpx;
  flex-wrap: wrap;
}

.radio-item {
  display: flex;
  align-items: center;
  gap: 12rpx;
  padding: 20rpx 28rpx;
  border-radius: $radius-md;
  font-size: 28rpx;
  transition: all 0.2s ease;

  .theme-light & {
    background: #f8f9fa;
    color: $light-text-primary;

    &.active {
      background: rgba(30, 90, 60, 0.1);
      color: $primary-green;
    }
  }

  .theme-dark & {
    background: rgba(255, 255, 255, 0.06);
    color: $dark-text-primary;

    &.active {
      background: rgba(30, 90, 60, 0.2);
      color: #4ade80;
    }
  }
}

// ============================================================
// 保留旧的类名兼容（防止子组件样式丢失）
// ============================================================

.signup-header,
.signup-body,
.step-wrapper,
.step-header,
.section-card,
.form-panel,
.bottom-actions {
  // 这些类名不再使用，但保留以防万一
  display: none;
}
