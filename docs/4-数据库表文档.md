# æ•°æ®åº“è¡¨æ–‡æ¡£

> **åˆ›å»ºæ—¶é—´**: 2025å¹´12æœˆ02æ—¥ 23:50  
> **æœ€åæ›´æ–°**: 2025å¹´12æœˆ02æ—¥ 23:50  
> **ç»´æŠ¤äºº**: Cursor AI  
> **æ•°æ®åº“ç±»å‹**: SQLite / PostgreSQL

---

## ğŸ“‹ è¡¨å˜æ›´è®°å½•

| æ—¶é—´ | å˜æ›´ç±»å‹ | è¡¨å | å˜æ›´å†…å®¹ | æ“ä½œäºº |
|------|----------|------|----------|--------|
| 2025å¹´12æœˆ02æ—¥ 23:50 | æ•´åˆ | - | æ•´ç†ç°æœ‰è¡¨ç»“æ„ | Cursor AI |
| 2024å¹´01æœˆ28æ—¥ | æ–°å¢ | signup_companions | åŒè¡Œäººå‘˜è¡¨ | - |

---

## ğŸ“Š è¡¨ç»“æ„æ¸…å•

### 1. users - ç”¨æˆ·è¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ | çº¦æŸ |
|------|------|------|------|
| id | INTEGER | ä¸»é”® | PRIMARY KEY |
| openid | VARCHAR(64) | å¾®ä¿¡ OpenID | UNIQUE |
| nickname | VARCHAR(50) | æ˜µç§° | - |
| avatar_url | VARCHAR(255) | å¤´åƒ URL | - |
| phone | VARCHAR(20) | æ‰‹æœºå· | - |
| email | VARCHAR(100) | é‚®ç®± | - |
| organization | VARCHAR(100) | å•ä½ | - |
| position | VARCHAR(50) | èŒä½ | - |
| created_at | DATETIME | åˆ›å»ºæ—¶é—´ | DEFAULT NOW |
| updated_at | DATETIME | æ›´æ–°æ—¶é—´ | - |

### 2. admins - ç®¡ç†å‘˜è¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ | çº¦æŸ |
|------|------|------|------|
| id | INTEGER | ä¸»é”® | PRIMARY KEY |
| username | VARCHAR(50) | ç”¨æˆ·å | UNIQUE |
| password_hash | VARCHAR(255) | å¯†ç å“ˆå¸Œ | NOT NULL |
| name | VARCHAR(50) | å§“å | - |
| role | VARCHAR(20) | è§’è‰² | DEFAULT 'admin' |
| is_active | BOOLEAN | æ˜¯å¦å¯ç”¨ | DEFAULT TRUE |
| created_at | DATETIME | åˆ›å»ºæ—¶é—´ | DEFAULT NOW |

### 3. activities - æ´»åŠ¨è¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ | çº¦æŸ |
|------|------|------|------|
| id | INTEGER | ä¸»é”® | PRIMARY KEY |
| title | VARCHAR(200) | æ´»åŠ¨æ ‡é¢˜ | NOT NULL |
| description | TEXT | æ´»åŠ¨æè¿° | - |
| cover_image_url | VARCHAR(255) | å°é¢å›¾ç‰‡ | - |
| start_time | DATETIME | å¼€å§‹æ—¶é—´ | - |
| end_time | DATETIME | ç»“æŸæ—¶é—´ | - |
| location | VARCHAR(200) | æ´»åŠ¨åœ°ç‚¹ | - |
| address | VARCHAR(500) | è¯¦ç»†åœ°å€ | - |
| max_participants | INTEGER | æœ€å¤§äººæ•° | - |
| status | VARCHAR(20) | çŠ¶æ€ | DEFAULT 'draft' |
| publish_time | DATETIME | å‘å¸ƒæ—¶é—´ | - |
| archive_time | DATETIME | å½’æ¡£æ—¶é—´ | - |
| signup_deadline | DATETIME | æŠ¥åæˆªæ­¢ | - |
| checkin_token | VARCHAR(100) | ç­¾åˆ°ä»¤ç‰Œ | - |
| created_by | INTEGER | åˆ›å»ºäºº | FK â†’ admins.id |
| created_at | DATETIME | åˆ›å»ºæ—¶é—´ | DEFAULT NOW |
| updated_at | DATETIME | æ›´æ–°æ—¶é—´ | - |

### 4. activity_form_fields - æ´»åŠ¨è¡¨å•å­—æ®µè¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ | çº¦æŸ |
|------|------|------|------|
| id | INTEGER | ä¸»é”® | PRIMARY KEY |
| activity_id | INTEGER | æ´»åŠ¨ ID | FK â†’ activities.id |
| name | VARCHAR(50) | å­—æ®µå | NOT NULL |
| label | VARCHAR(100) | å­—æ®µæ ‡ç­¾ | NOT NULL |
| field_type | VARCHAR(20) | å­—æ®µç±»å‹ | NOT NULL |
| required | BOOLEAN | æ˜¯å¦å¿…å¡« | DEFAULT FALSE |
| display_order | INTEGER | æ˜¾ç¤ºé¡ºåº | DEFAULT 0 |
| options | JSON | é€‰é¡¹é…ç½® | - |

### 5. signups - æŠ¥åè¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ | çº¦æŸ |
|------|------|------|------|
| id | INTEGER | ä¸»é”® | PRIMARY KEY |
| activity_id | INTEGER | æ´»åŠ¨ ID | FK â†’ activities.id |
| user_id | INTEGER | ç”¨æˆ· ID | FK â†’ users.id |
| status | VARCHAR(20) | æŠ¥åçŠ¶æ€ | DEFAULT 'pending' |
| review_status | VARCHAR(20) | å®¡æ ¸çŠ¶æ€ | DEFAULT 'pending' |
| review_time | DATETIME | å®¡æ ¸æ—¶é—´ | - |
| review_by | INTEGER | å®¡æ ¸äºº | FK â†’ admins.id |
| review_note | TEXT | å®¡æ ¸å¤‡æ³¨ | - |
| checkin_status | VARCHAR(20) | ç­¾åˆ°çŠ¶æ€ | DEFAULT 'not_checked' |
| checkin_time | DATETIME | ç­¾åˆ°æ—¶é—´ | - |
| created_at | DATETIME | åˆ›å»ºæ—¶é—´ | DEFAULT NOW |
| updated_at | DATETIME | æ›´æ–°æ—¶é—´ | - |

### 6. signup_answers - æŠ¥åç­”æ¡ˆè¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ | çº¦æŸ |
|------|------|------|------|
| id | INTEGER | ä¸»é”® | PRIMARY KEY |
| signup_id | INTEGER | æŠ¥å ID | FK â†’ signups.id |
| field_id | INTEGER | å­—æ®µ ID | FK â†’ activity_form_fields.id |
| value_text | TEXT | æ–‡æœ¬å€¼ | - |
| value_json | JSON | JSON å€¼ | - |

### 7. signup_companions - åŒè¡Œäººå‘˜è¡¨

> **åˆ›å»ºæ—¶é—´**: 2024å¹´01æœˆ28æ—¥  
> **è¿ç§»æ–‡ä»¶**: `008_add_signup_companions.py`

| å­—æ®µ | ç±»å‹ | è¯´æ˜ | çº¦æŸ |
|------|------|------|------|
| id | INTEGER | ä¸»é”® | PRIMARY KEY |
| signup_id | INTEGER | æŠ¥å ID | FK â†’ signups.id |
| name | VARCHAR(50) | å§“å | NOT NULL |
| phone | VARCHAR(20) | æ‰‹æœºå· | - |
| id_card | VARCHAR(20) | èº«ä»½è¯å· | - |
| relationship | VARCHAR(20) | å…³ç³» | - |
| created_at | DATETIME | åˆ›å»ºæ—¶é—´ | DEFAULT NOW |

### 8. favorites - æ”¶è—è¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ | çº¦æŸ |
|------|------|------|------|
| id | INTEGER | ä¸»é”® | PRIMARY KEY |
| user_id | INTEGER | ç”¨æˆ· ID | FK â†’ users.id |
| activity_id | INTEGER | æ´»åŠ¨ ID | FK â†’ activities.id |
| created_at | DATETIME | åˆ›å»ºæ—¶é—´ | DEFAULT NOW |

### 9. likes - ç‚¹èµè¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ | çº¦æŸ |
|------|------|------|------|
| id | INTEGER | ä¸»é”® | PRIMARY KEY |
| user_id | INTEGER | ç”¨æˆ· ID | FK â†’ users.id |
| activity_id | INTEGER | æ´»åŠ¨ ID | FK â†’ activities.id |
| created_at | DATETIME | åˆ›å»ºæ—¶é—´ | DEFAULT NOW |

### 10. shares - åˆ†äº«è¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ | çº¦æŸ |
|------|------|------|------|
| id | INTEGER | ä¸»é”® | PRIMARY KEY |
| user_id | INTEGER | ç”¨æˆ· ID | FK â†’ users.id (å¯ç©º) |
| activity_id | INTEGER | æ´»åŠ¨ ID | FK â†’ activities.id |
| channel | VARCHAR(20) | åˆ†äº«æ¸ é“ | - |
| created_at | DATETIME | åˆ›å»ºæ—¶é—´ | DEFAULT NOW |

### 11. comments - è¯„è®ºè¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ | çº¦æŸ |
|------|------|------|------|
| id | INTEGER | ä¸»é”® | PRIMARY KEY |
| user_id | INTEGER | ç”¨æˆ· ID | FK â†’ users.id |
| activity_id | INTEGER | æ´»åŠ¨ ID | FK â†’ activities.id |
| content | TEXT | è¯„è®ºå†…å®¹ | NOT NULL |
| created_at | DATETIME | åˆ›å»ºæ—¶é—´ | DEFAULT NOW |

### 12. feedbacks - åé¦ˆè¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ | çº¦æŸ |
|------|------|------|------|
| id | INTEGER | ä¸»é”® | PRIMARY KEY |
| user_id | INTEGER | ç”¨æˆ· ID | FK â†’ users.id |
| activity_id | INTEGER | æ´»åŠ¨ ID | FK â†’ activities.id |
| rating | INTEGER | è¯„åˆ† (1-5) | - |
| content | TEXT | åé¦ˆå†…å®¹ | - |
| is_public | BOOLEAN | æ˜¯å¦å…¬å¼€ | DEFAULT FALSE |
| created_at | DATETIME | åˆ›å»ºæ—¶é—´ | DEFAULT NOW |

### 13. badges - å¾½ç« è¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ | çº¦æŸ |
|------|------|------|------|
| id | INTEGER | ä¸»é”® | PRIMARY KEY |
| code | VARCHAR(50) | å¾½ç« ä»£ç  | UNIQUE |
| name | VARCHAR(100) | å¾½ç« åç§° | NOT NULL |
| description | TEXT | å¾½ç« æè¿° | - |
| icon_url | VARCHAR(255) | å›¾æ ‡ URL | - |
| criteria | JSON | è·å–æ¡ä»¶ | - |
| is_active | BOOLEAN | æ˜¯å¦å¯ç”¨ | DEFAULT TRUE |
| created_at | DATETIME | åˆ›å»ºæ—¶é—´ | DEFAULT NOW |

### 14. user_badges - ç”¨æˆ·å¾½ç« è¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ | çº¦æŸ |
|------|------|------|------|
| id | INTEGER | ä¸»é”® | PRIMARY KEY |
| user_id | INTEGER | ç”¨æˆ· ID | FK â†’ users.id |
| badge_id | INTEGER | å¾½ç«  ID | FK â†’ badges.id |
| activity_id | INTEGER | å…³è”æ´»åŠ¨ | FK â†’ activities.id |
| note | TEXT | å¤‡æ³¨ | - |
| awarded_at | DATETIME | æˆäºˆæ—¶é—´ | DEFAULT NOW |

### 15. badge_rules - å¾½ç« è§„åˆ™è¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ | çº¦æŸ |
|------|------|------|------|
| id | INTEGER | ä¸»é”® | PRIMARY KEY |
| badge_id | INTEGER | å¾½ç«  ID | FK â†’ badges.id |
| rule_type | VARCHAR(50) | è§„åˆ™ç±»å‹ | NOT NULL |
| threshold | INTEGER | é˜ˆå€¼ | - |
| scope | JSON | ä½œç”¨èŒƒå›´ | - |
| is_active | BOOLEAN | æ˜¯å¦å¯ç”¨ | DEFAULT TRUE |
| created_at | DATETIME | åˆ›å»ºæ—¶é—´ | DEFAULT NOW |

### 16. notification_logs - é€šçŸ¥æ—¥å¿—è¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ | çº¦æŸ |
|------|------|------|------|
| id | INTEGER | ä¸»é”® | PRIMARY KEY |
| user_id | INTEGER | ç”¨æˆ· ID | FK â†’ users.id |
| event_type | VARCHAR(50) | äº‹ä»¶ç±»å‹ | NOT NULL |
| title | VARCHAR(200) | æ ‡é¢˜ | - |
| content | TEXT | å†…å®¹ | - |
| status | VARCHAR(20) | çŠ¶æ€ | DEFAULT 'pending' |
| sent_at | DATETIME | å‘é€æ—¶é—´ | - |
| retry_count | INTEGER | é‡è¯•æ¬¡æ•° | DEFAULT 0 |
| created_at | DATETIME | åˆ›å»ºæ—¶é—´ | DEFAULT NOW |

### 17. audit_logs - å®¡è®¡æ—¥å¿—è¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ | çº¦æŸ |
|------|------|------|------|
| id | INTEGER | ä¸»é”® | PRIMARY KEY |
| admin_id | INTEGER | ç®¡ç†å‘˜ ID | FK â†’ admins.id |
| action | VARCHAR(50) | æ“ä½œç±»å‹ | NOT NULL |
| entity_type | VARCHAR(50) | å®ä½“ç±»å‹ | - |
| entity_id | INTEGER | å®ä½“ ID | - |
| metadata | JSON | å…ƒæ•°æ® | - |
| created_at | DATETIME | åˆ›å»ºæ—¶é—´ | DEFAULT NOW |

---

## ğŸ“ å˜æ›´è®°å½•

| æ—¶é—´ | å˜æ›´å†…å®¹ | æ“ä½œäºº |
|------|----------|--------|
| 2025å¹´12æœˆ02æ—¥ 23:50 | åˆ›å»ºæ–‡æ¡£ï¼Œæ•´ç†æ‰€æœ‰è¡¨ç»“æ„ | Cursor AI |

---

**ä¸‹æ¬¡æ›´æ–°**: æ–°å¢è¡¨æˆ–ä¿®æ”¹è¡¨ç»“æ„æ—¶åŒæ­¥æ›´æ–°

