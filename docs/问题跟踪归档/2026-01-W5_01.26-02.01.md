# 问题跟踪文档（2026年第5周）

> **周次**: 2026年1月第5周（1月26日-2月1日）
> **创建时间**: 2026年1月5日
> **最后更新**: 2026年1月29日 14:30
> **维护人**: Cursor AI + 用户

---

## 📋 使用说明

本文档用于跟踪本周（2026年1月26日-2月1日）的问题、Bug 和需求。

### 问题状态

| 状态 | 说明 |
|------|------|
| 🔴 待处理 | 新提出的问题，等待处理 |
| 🟡 处理中 | 正在解决中 |
| 🟢 已解决 | 问题已修复 |
| ⚪ 已关闭 | 问题已关闭（无需处理或重复） |

---

## 🟡 处理中

### #W5-001: 评论功能完整开发

**提出时间**: 2026年1月28日  
**优先级**: P1  
**状态**: 🟡 处理中（待确认）

**已完成的提交**：

| 提交ID | 描述 |
|--------|------|
| 617c8df | 评论/互动/用户服务层 |
| a3faca7 | 评论功能UI优化 |
| 1a92529 | 评论功能交互优化 |
| 63e560d | 连接线改为真正连续的弧线 |
| ac80c48 | 评论功能多项交互修复 |

---

**用户反馈（第8轮）**：
1. 回复弹窗：每个人的评论依旧没有回复按钮的三个点
2. 回复弹窗：评论框贴近屏幕底部，左右下角被截断（iPhone 16 Pro）
3. 评论列表：拖拽条依旧没有生效，有卡顿bug
4. 评论列表：最后一条评论的菜单底部被截断
5. 三点菜单样式：需要有色块和小图标（按设计稿）

**关于评论权限机制**：
- 一般社交软件设计：用户只能删除**自己发的**评论/回复
- 原评论者**无法**删除别人的回复（除非是管理员/版主）
- 已按此逻辑实现：仅当评论者是当前用户时显示"删除"，否则显示"取消"

**AI回复（第8轮修复）**：

1. ✅ **三点菜单样式 - 按设计稿重做**
   - 添加图标：💬 回复 / 🗑️ 删除/取消
   - 添加色块：回复（白色背景）/ 删除（浅红色背景 #fff5f5）
   - 圆角卡片样式：`border-radius: 16rpx`
   - 阴影效果：`box-shadow: 0 8rpx 32rpx rgba(0,0,0,0.12)`

2. ✅ **回复弹窗 - 每条回复都有三点菜单**
   - 确保 `.reply-menu` 在每条回复中正确显示
   - 菜单样式与评论列表保持一致

3. ✅ **iPhone 16 Pro 安全区域**
   - 回复弹窗底部：`padding-bottom: calc(24rpx + env(safe-area-inset-bottom))`
   - 评论输入面板：`padding-bottom: calc(24rpx + env(safe-area-inset-bottom))`

4. ✅ **拖拽条点击关闭**
   - 增大点击区域：高度从 8rpx 增加到 40rpx
   - 使用 `::after` 伪元素显示拖拽条
   - 添加 `e.stopPropagation()` 确保事件正确触发

5. ✅ **最后一条评论菜单向上展开**
   - CSS：`&:last-child .menu-action-sheet { bottom: 100%; top: auto; }`
   - 防止菜单被页面底部截断

**修改文件**：
- `CommentList.tsx` - 菜单改为带图标色块样式
- `CommentList.scss` - 新增 `.menu-action-sheet` 样式，最后一条向上展开
- `ReplyPanel.tsx` - 原评论和每条回复的菜单改为新样式
- `ReplyPanel.scss` - 菜单样式、底部安全区域
- `index.tsx` - 拖拽条事件阻止冒泡
- `index.scss` - 拖拽条增大点击区域、底部安全区域

**待确认**：请测试后反馈

---

## 📝 2026年1月29日 工作记录

### 完成内容

1. 三点菜单重新设计（带图标和色块）
2. iPhone 16 Pro 安全区域适配
3. 拖拽条点击关闭修复
4. 最后一条评论菜单向上展开
5. 评论权限机制说明

---

## 🔗 相关文档

- [项目进度文档](../1-项目进度文档.md)
- [代码规范文档](../2-代码规范文档.md)

---

**归档提醒**: 本周日（2月1日）将本周问题归档
