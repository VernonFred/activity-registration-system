# 问题跟踪文档（2026年第9周）

> **周次**: 2026年2月第4周（2月23日-3月1日）
> **创建时间**: 2026年1月5日
> **最后更新**: 2026年2月26日 14:30
> **维护人**: Cursor AI + 用户

---

## 📋 使用说明

本文档用于跟踪本周（2026年2月23日-3月1日）的问题、Bug 和需求。

### 问题状态

| 状态 | 说明 |
|------|------|
| 🔴 待处理 | 新提出的问题，等待处理 |
| 🟡 处理中 | 正在解决中 |
| 🟢 已解决 | 问题已修复 |
| ⚪ 已关闭 | 问题已关闭（无需处理或重复） |

### 优先级

| 优先级 | 说明 |
|--------|------|
| P0 | 紧急，阻塞开发 |
| P1 | 高优先级，尽快处理 |
| P2 | 中优先级，正常排期 |
| P3 | 低优先级，有空处理 |

---

## 🟡 处理中

> 当前有 1 个处理中问题（#002）

---

## 🔴 待处理

> 当前有 1 个待处理问题

### #001 评论连接线UI问题

- **提出时间**: 2026年2月25日 
- **提出人**: 用户
- **优先级**: P1
- **状态**: 🔴 待处理
- **问题描述**: 
  - 评论链接线UI问题依旧有问题，先将问题录日技术债务，接下来根据设计稿重构「我的」页面，首先是是「我的」中的「活动列表」页面

---


### #002 「我的-活动列表」页面构建

- **提出时间**: 2026年2月25日 
- **提出人**: 用户
- **优先级**: P1
- **状态**: 🟢 已解决 
- **问题描述**: 
  - 暗黑模式下的卡片不是纯黑色（没有与首页的暗黑模式保持一致），似乎深黑紫色
  - 将卡片内容展开后，底部的导航胶囊遮挡住了底部的分页器
  - 将整个页面的所有功能前后端打通（包括不限于签到、修改报名信息、完善交通信息、查看参会凭证、点赞、评论、收藏、分享等等），这些功能都有对应的页面
 - **问题描述（2026年2月25日 15:00）**: 
  - 卡片内容展开后，点击三点交互的按钮，「修改报名信息」与「取消报名」的小卡片样式被截断了，没有显示出来
  - 如果已经点赞，那么点击点赞按钮应该是取消点赞，点赞按钮应该变成空心灰色状态（但是依旧是红色实心状态），收藏按钮应该也是这样的逻辑
  - 去签到的页面，应该是设计稿中的样式（目前不是的，我已经帮你选中），完成签到后，「带签到」按钮应该变成「已签到」的按钮
  - 完善交通信息，应该直接跳转到填写交通信息的步骤页面（前面已经填写过的信息应该是需要有所显示的，理解吗？）
  - 去缴费的页面，应该也是直接跳转到缴费的步骤

 - **问题描述（2026年2月25日 15:38）**: 
  - 「去缴费」的按钮没有绑定跳转事件
  - 填写交通信息的步骤页面，底部的按钮与返程信息重叠了，填写完交通信息后返回，「完善交通信息」这个文案应该就没有
  - 点击评论，应该是以当前用户进行评论，但是目前前后端并没有打通
  - 去缴费的页面，应该也是直接跳转到缴费的步骤
  - 还有个问题，目前整个系统没有规划审核的机制了，这跟产品规划方向有关，所以目前的mock数据也不需要有「审核」、「驳回｜这样的mock数据展示
  - 将翻页机制也进行触发
  - 卡片展开后，需要多增加几个报名数据，我需要看到「添加同行人员」的按钮（看设计图）

 - **问题描述（2026年2月25日 15:38）**: 
  - 填写交通信息的步骤页面，底部的按钮遮住了返程信息中的时间和航班号的文本框
 - 点击评论，评论后，回到当前页面，评论的按钮并不是红色实心状态，而且再次去进行评论，并没有看到之前的评论内容
我需要打通目前所有的前后端功能，都必须是端到端的落实，所有的mock数据必须要已经实现端到端的打通，你需要深度仔细检查一下，你可以从底部导航岛的「首页」开始，一直到「我的-活动列表」进行端到端的打通，确保每一项功能都已经落实

总而言之，所有的功能必须是前后端全部端到端的落实与打通，达到交付的标准，所有流程必须全部打通
- **问题描述（2026年2月25日 16:20）**:
  - 填写交通信息步骤中，返程信息文本框依旧被底部按钮遮挡/截断
  - 建议对交通信息页做设计调整：将「到达信息」与「返程信息」改成左右滑动切换，避免两张卡片同时堆叠造成遮挡
- **问题描述（2026年2月25日 16:40）**:
  - 去掉「左右滑动切换到达/返程信息」文案
  - 交通信息滑动切换的小圆点不明显/看不到
  - 底部「下一步/保存」按钮区域仍有明显底部分割背景，不需要该背景层
- **问题描述（2026年2月25日 16:38）**:
  - 去掉「到达信息/返程信息」的胶囊按钮（与卡片标题重复）
  - 交通信息滑动切换的小圆点与信息卡片距离太远，需要缩小间距
  - 签到页面样式需要严格参考设计图重构

- **问题描述（2026年2月25日 16:57）**:
  - 交通信息滑动切换的小圆点不与信息卡片距离依旧太远，需要再次缩小间距
  - 关于签到的页面，与设计稿样式不符合，“立即签到”的字是渐变色的，不需要圆形的灰色背景，仔细查看设计稿件
  - 当活动卡片展开，有“待缴费”、“待签到”的时候，只显示了“去缴费”，并没有显示“去签到”
- **问题描述（2026年2月25日 17:22）**:
  - 补充说明：签到页需要“渐变文字 + 渐变圆圈”，不要灰色圆形背景（当前实现方向理解偏差）
- **问题描述（2026年2月25日 17:40）**:
  - 签到成功页面需要按设计稿调整：同心圆为渐变色边框，底部信息前增加小图标（禁用 emoji）
  - 活动卡片样式严重偏离设计稿（需参考「我的-活动列表」设计稿重构样式细节）
- **问题描述（2026年2月25日 17:58）**:
  - 设计稿澄清：卡片内部点赞/评论/收藏/分享区域不需要细线分隔
  - 设计稿澄清：下方展开线框容器内，不同人员行之间需要横线分隔（此前理解反了）

- **问题描述（2026年2月26日 09:55）**:
  - 「我的-活动列表」页面，展开后不是“实心分层卡片”，设计稿是：上半部分主卡片，下半部分是一个“线框容器”，视觉上像一张卡展开后，下面拉出一个带边框的面板，目前的整体设计不符合设计稿，调用sketch，查看设计稿，进行修复


- **问题描述（2026年2月26日 10:42）**:
  - 调整优化一下「待缴费」「待签到」“完善交通信息”这些小标签和文案，目前文字被挤压了
  - 关于签到与签到成功的页面UI，你是否可以提供更好的创意UI方案？
  - 先同步更新相关的所有的md文档，然后提交GitHub，然后再进行修改

- **问题描述（2026年2月26日 10:56）**:
  - 三个横线的圆点改成纵向的，节省空间
  - 当小标签比较多的时候，“完善交通信息”的文字容易被挤压，彼此之间的距离太窄
  - 暗黑模式下，线框的背景是需要去掉的
  - 修改完成后，先提交提交GitHub
  - 签到的方案，先采用方案b，我看一下

- **问题描述（2026年2月26日 11:16）**:
  - 当小标签比较多的时候，“完善交通信息”的文字容易被挤压，你采取的方案是换行，但是，换行的话，需要把标签与姓名左对齐，目前标签是在姓名的右下方的
  - 签到的方案，方案b不好看，用方案c进行调整，动态的效果要强一些
  - 还有个问题，我发现成功签到后，待缴费就会变成「已缴费」，代码逻辑需要你检查一下

- **问题描述（2026年2月26日 11:16）**:
  - 当小标签比较多的时候，又有“完善交通信息”的文字，是需要换行的，否则文字就会被挤压，但是如果没有“完善交通信息”这个文字，标签是不用换行的，理解吗？
  - 签到的方案，动态感不强，UI创意不够，你可以先忽略我关于签到页面设计，利用你顶级视觉交互的审美，帮我构建极具创意性的签到与签到成功的页面

- **问题描述（2026年2月26日 11:44）**:
  - 没有"完善交通信息"时，标签不要挨着姓名，要靠右对齐，在三点的旁边（跟我的设计稿一样，理解吗）
  - 有"完善交通信息"时，"完善交通信息"是放在姓名旁边的，标签小于4个的时候，就不用换行，标签大于等于4个的时候，就换行左对齐
  - 签到的方案，签到前的动效再强一些，签到中的效果似乎没有展示出来，而且绿色勾选球在签到中不能够被展示出来（目前是展示出来的），签到后的页面不好看（不要座位的信息），我觉得最好不要绿色勾选球，太丑了，你要发挥你顶级视觉交互师的创意，重新构想更创意、精致美观的页面

- **问题描述（2026年2月26日 14:00）**:
  - 关于参会凭证的页面UI，我需要你提供一下几个创意的方案，我对于目前的设计稿不满意

- **问题描述（2026年2月26日 14:00）**:
  - 参会凭证的上面的城市缩写码需要与真实的活动地点保持一致，这个前后端的功能需要打通
  - 修改完成后，同步更新所有的相关的进度文档（比如项目进度、下一步规划、数据库表、API、组件库等等），只要涉及到相关文档的，都需要更新
  - 然后提交GitHub

- **问题描述（2026年2月26日 14:30）**:
  - 卡片展开后，点击三点，「修改报名信息」与「取消报名」的小卡片在线框中被截断了（看截图）
  - 顶部的长条导航，不需要有任何颜色的背景
  - 修改完成后（先同步更新所有文档，提交GitHub），接下来开始重构「我的-徽章」页面，调用sketch，查看我的设计稿件

- **解决情况（2026年2月26日 14:45）**:
  - 已修复三点菜单被线框容器截断：移除`.record-detail-panel`的`overflow: hidden`属性
  - 已去除顶部Tab切换栏背景色：`.tab-bar`背景改为`transparent`、边框去除、active状态不再使用绿色背景，未选中图标降低透明度区分
  - 构建验证通过

- **解决情况（2026年2月26日 15:00 — 徽章页重构）**:
  - 已完成「我的-徽章」Tab全面重构，严格对标Sketch设计稿：
    - **Hero区域**: 110px圆角绿色徽章展示 + "新获得"标签 + 累积成就统计 + 🏆徽章墙入口按钮
    - **分类Tab**: 启程成就/互动成就/荣誉成就/隐藏彩蛋，带下划线指示器
    - **徽章网格**: 3列布局，已获得彩色 vs 未获得灰度+描述文字，圆角白卡片
    - **隐藏彩蛋**: 未解锁时显示3D金字塔+「期待您的解锁」按钮；点击后显示隐藏徽章列表
    - **暗色主题**: 完整适配
  - 新建「徽章墙」独立页面 `/pages/badge-wall/index`：
    - 用户信息 + 累积成就/超越用户百分比
    - 2列网格展示所有已获得徽章
    - 暗色主题适配
  - Badge类型扩展: 新增`BadgeCategory`枚举、`description`、`earned_at`、`is_featured`、`is_hidden`字段
  - Mock数据扩充: 4分类17枚徽章（启程4 + 互动6 + 荣誉3 + 彩蛋4），含解锁条件描述
  - 路由配置更新: `app.config.ts`新增`badge-wall`页面
  - 构建验证通过

- **解决情况（2026年2月26日 14:30）**:
  - 已完成参会凭证页"数字护照印章"风格全新设计实现：
    - 米色护照纸张质感背景 + SVG噪点纹理
    - 圆形红色印章（城市缩写码 + 日期），弹性落下动画 + 油墨飞溅效果
    - CONFERENCE CREDENTIAL英文标签 + 活动标题 + 参会人/地点/日期字段
    - MRZ机读码装饰区 + VERIFIED绿色盖章标记
    - 暗黑模式完整适配（深棕色调）
  - 已打通城市缩写码前后端数据流：
    - 前端`getCityCode`函数支持16个常见城市名→缩写映射（北京→BJ、上海→SH等）
    - 统一兼容三套字段命名：backend(`city`+`location`) / mock signup(`location_city`+`location_name`) / mock activity(`location`+`venue`)
    - 凭证页和签到页均已适配，可自动从API/Mock数据中正确提取城市和地点信息
  - 已修复签到页同样的字段名不对齐问题
  - 已同步更新所有相关进度文档
  - 构建验证通过，已提交GitHub

- **解决情况（2026年2月26日 11:15）**:
  - 已将三点菜单从横向（•••）改为纵向（⋮），节省横向空间
  - 已优化参与人行标签间距：gap增大至8px/10px，字号从10px提至11px，添加flex-wrap防止挤压
  - 已修复暗黑模式线框容器背景：从#1a1e22改为transparent
  - 已提交GitHub（commit 00192a6）
  - 已实现签到页方案B（电子凭证票据风格）：
    - 签到前：票据卡片布局（上半活动信息 + 撕裂线 + 下半印章签到按钮）
    - 签到后：票据成功页（左上标题 + 同心圆勾选 + 撕裂线 + 签到时间/地点/座位信息）
    - 保留渐变圆圈按钮与设计稿一致
  - 构建验证通过

- **解决情况（2026年2月25日 15:58）**:
  - 已接入 Sketch MCP，并基于「我的-活动列表」画板（13:289）完成页面结构与样式对齐重构
  - 已关闭 Profile 页原生导航栏，补充顶部胶囊按钮避让逻辑，避免内容被右上角胶囊压住
  - 已完成活动列表卡片/展开区重构，暗黑模式卡片色值调整为首页一致的纯黑系风格
  - 已修复展开内容后分页器被底部导航胶囊遮挡的问题（增加内容底部安全间距）
  - 已打通活动列表主要功能跳转/接口：修改报名信息、添加同行人员、缴费入口、评论、点赞、收藏、分享、取消报名
  - 已新增并接入「签到」页与「参会凭证」页（我的页面可直接跳转）
  - 已修复展开卡片三点菜单弹层被卡片裁切的问题（菜单卡片可完整显示）
  - 已修复点赞/收藏二次点击状态切换逻辑（支持取消点赞/取消收藏，图标与颜色状态同步切换）
  - 已将「完善交通信息」改为直达报名页交通信息步骤，并预填已填写信息
  - 已将「去缴费」改为直达报名页缴费步骤，并预填已填写信息
  - 已补齐签到状态本地联动（完成签到后返回“我的”页可显示为“已签到”）
  - 已修复报名页交通信息步骤底部按钮与返程信息区域重叠（增加表单底部安全间距）
  - 已支持活动列表分页交互（页码/上一页/下一页点击生效）
  - 已扩充并调整 mock 报名数据（移除审核/驳回态展示，补充可翻页与“添加同行人员”场景）
  - 已接入评论页用户与评论/评分数据加载及评论提交/点赞接口（Mock/真实接口双通路）
  - 联调说明：签到真实接口当前后端为管理员权限接口（且需要签到码），Mock 模式已完成页面与调用链路接通
- **解决情况（2026年2月25日 16:30）**:
  - 已按建议重构交通信息步骤：将「到达信息 / 返程信息」改为分段切换 + 左右滑动（Swiper）交互
  - 交通信息步骤当前仅展示单张卡片，避免返程信息表单被底部按钮栏遮挡
  - 保留底部操作按钮与安全区适配；构建已通过（`pnpm -C frontend/app run build:weapp`）
- **解决情况（2026年2月25日 16:48）**:
  - 已移除交通信息步骤中的「左右滑动切换到达/返程信息」提示文案
  - 已增强滑动分页圆点的尺寸与对比度（浅色/深色主题均可见）
  - 已移除底部按钮区域的分割背景层（按钮直接悬浮在弹窗表单容器上）
  - 构建验证通过（`pnpm -C frontend/app run build:weapp`）
- **解决情况（2026年2月25日 17:05）**:
  - 已移除交通信息步骤顶部「到达信息/返程信息」胶囊切换按钮，仅保留卡片标题与左右滑动切换
  - 已缩小滑动圆点与信息卡片的上下间距，避免圆点离卡片过远
  - 已按设计稿重构签到页面视觉样式（背景氛围、弹窗卡片、签到按钮环、关闭按钮位置）
  - 构建验证通过（`pnpm -C frontend/app run build:weapp`）
- **解决情况（2026年2月25日 17:18）**:
  - 已再次缩小交通信息滑动圆点与信息卡片的距离（通过降低 `Swiper` 高度，减少卡片下方留白）
  - 已调整签到页「立即签到」按钮文字为纯色视觉（按用户补充，不添加圆形灰色背景）
  - 已修复活动卡片展开主报名人行在“待缴费 + 待签到”场景下同时显示「去缴费」「去签到」
  - 构建验证通过（`pnpm -C frontend/app run build:weapp`）
- **解决情况（2026年2月25日 17:28）**:
  - 已按补充说明修正签到页按钮样式：恢复「立即签到」渐变文字 + 渐变圆圈边框，同时去掉灰色圆形背景
  - 构建验证通过（`pnpm -C frontend/app run build:weapp`）
- **解决情况（2026年2月25日 17:52）**:
  - 已按设计稿调整签到成功页：同心圆改为渐变描边效果，中心勾选保留绿色圆形；底部签到时间/签到地点前增加图片图标（非 emoji）
  - 已重构活动卡片关键样式以贴近设计稿（卡片圆角/阴影、状态标签、底部指标栏、展开区行高与操作按钮/菜单样式）
  - 构建验证通过（`pnpm -C frontend/app run build:weapp`）
- **解决情况（2026年2月25日 18:02）**:
  - 已按澄清修正活动卡片指标栏样式：移除点赞/评论/收藏/分享区域的细线分隔
  - 保留展开线框容器内人员行横线分隔样式（与设计稿一致）
- **解决情况（2026年2月26日 10:10）**:
  - 已通过 Sketch MCP 分析「我的-活动列表」画板层级结构，获取精确设计规格：
    - 主卡片：白色背景 `#ffffff`，边框 `0.5px #e5e5e5`，圆角 `15px`
    - 线框容器：灰色背景 `#f2f2f2`，边框 `0.5px #a6a6a6`（比卡片边框更深），比卡片窄约 8px（内缩）
  - 重构 TSX 结构：将 `.record-detail-panel` 从卡片内部移至外部，形成"主卡片 + 线框容器"分层结构
    - 新增 `.signup-record-wrapper` 包裹卡片和面板
    - 卡片始终保持完整圆角（z-index: 2），面板在卡片下方（z-index: 1）
  - 重构 SCSS 样式：
    - 线框容器使用 `margin: -14px 8px 0`（负边距使其藏于卡片底部，8px 内缩形成窄于卡片的效果）
    - 线框容器使用 `#f2f2f2` 背景 + `1px #a6a6a6` 边框 + `0 0 16px 16px` 底部圆角
    - 分隔线颜色调整为 `rgba(166, 166, 166, 0.3)` 匹配设计稿
  - 暗黑模式同步更新（线框容器 `#1a1e22` 背景 + 白色透明边框）
  - 构建验证通过（`pnpm -C frontend/app run build:weapp`）


### #003 「我的-徽章」页面构建

- **提出时间**: 2026年2月26日 
- **提出人**: 用户
- **优先级**: P1
- **状态**: 🟢 已解决  
- **问题描述**: 
  - 徽章图片已经在项目目录下，文件夹「徽章」
  - 我需要你先忽略我的设计稿件，以顶级创意视觉交互师的思维帮我提供几套极具创意的UI样式页面设计方案

- **方案提出（2026年2月26日 15:15）**:
  - 提供4套方案：A.星际收藏馆 / B.勋章展柜 / C.探险地图 / D.荧光博物馆
  - 用户选择：**方案C 探险地图**（注意设计统一性）

- **实现进展（2026年2月26日 15:45）**:
  - 已将17枚3D徽章图片复制到 `frontend/app/src/assets/badges/`
  - BadgesTab组件重写为探险地图风格：
    - 羊皮卷纹理背景 + 顶底卷轴边缘装饰
    - 指南针Hero区（conic-gradient进度环 + N标记 + 进度数字）
    - 🚩最近发现Banner（虚线边框 + 真实徽章图片）
    - 4区域Tab（出发港口/社交广场/荣誉殿堂/迷雾秘境）含颜色圆点
    - 3列地标卡片：已发现带金色光晕脉冲+🏁旗帜，未发现带迷雾遮罩
    - 点击展开tooltip显示解锁条件/获得日期
    - 迷雾秘境：多层动态漂浮迷雾 + ？问号 + 金色「拨开迷雾」按钮
    - 地标入场动画（translateY + scale）
  - 徽章墙页面同步改为探险日志风格（卷轴边缘 + 金色光晕卡片）
  - Mock数据全部关联真实徽章图片（import方式）
  - 暗色主题完整适配（深棕色调 #1a1610）
  - 构建验证通过

- **问题描述（2026年2月26日 15:57）**: 
  - 探险地图风格不好看，与整体平台色调不符合，回归设计稿样式

- **问题描述（2026年2月26日 16:20）**: 
  - 新获得的徽章样式与设计稿不符合
  - 胶囊徽章墙的样式与设计稿不符合，应为无色/透明背景

- **问题描述（2026年2月26日 16:46）**: 
  - 胶囊徽章墙应放在右上角位置
  - Hero徽章图片去掉白色背景，直接放在绿色方块上
  - 隐藏彩蛋UI样式需要更有创意


- **问题描述（2026年2月26日 17:21）**: 
  - 初次登场下面缺一条文案：”首次报名活动“
  - 获得的每个徽章需要可以被点击，点击后放大显示，并且出现对应的slogan（在“Users/Python项目/活动报名系统/最新产品规划.md”中，理解吗？

- **问题描述（2026年2月27日 17:21）**: 
  - 徽章弹出的详情弹窗UI样式不好看，需要重新设计，不需要有白色的卡片背景，可以直接放在高斯模糊的背景上面，「关闭」的文字改成高级简约的按钮
  - 详情弹窗显示的时候，底部的胶囊导航岛不应该显示出来
在文档中回复我



- **问题描述（2026年2月27日 10:30）**:
  - 弹窗中徽章PNG图片白色背景太丑，mix-blend-mode方案效果不佳
  - 要求: 彻底抛弃PNG徽章图片，重新设计纯CSS徽章
  - 要求: 透明无背景、精致美观、高级简约，可以有动态效果
  - 要求: 禁用所有emoji图标
  - 要求: 符号需更精准匹配文案语义
  - 要求: 徽章墙页面也需同步修改

- **解决情况（2026年2月27日 11:00 — 全部修复完成）**:
  - 放弃探险地图风格，严格对标Sketch设计稿还原
  - 平台主色调（深绿#2d5a3d + 白底#f7f7f7 + Lovable风格）
  - **全新纯CSS徽章系统** — 彻底移除PNG图片依赖:
    - 圆形渐变色盘 + 装饰双环(外环+内环) + 中心Unicode符号
    - 17个徽章各自独立配色: 启程成就(绿系)、互动成就(蓝紫橙系)、荣誉成就(金系)、隐藏彩蛋(特殊色系)
    - 符号精准匹配文案: ▸初次登场 ✓成功入选 ⊙准时到场 ◆全勤达人 ❝开口有料 ※金句制造机 ❋人气发言者 ⊞任务执行者 ∞连续打卡 ✧活力不息 ❖徽章收藏家 ♡活动助力官 ✦活动之星 ↯闪电报名王 ☽午夜打卡者 ◎周年纪念章 ◉沉默观察员
    - 全部禁用emoji，使用纯Unicode几何符号
    - 多尺寸体系: sm(网格56px) / hero(90px) / wall(80px) / lg(弹窗148px)
    - 已获得: 全彩+发光阴影 / 未获得: 灰阶+低透明度
    - 弹窗大徽章: 外环呼吸脉动 + 扫光shimmer动画 + 背景辉光呼吸
  - Hero区：深绿倾斜方块层叠立体效果 + CSS徽章
  - 分类Tab：四类文字+绿色下划线
  - 3列网格：白卡+CSS徽章(已获得) / 灰底+灰度CSS徽章(未获得)
  - 隐藏彩蛋：极简光环设计
  - 徽章墙：浅灰背景 + 头像+双统计 + 2列白卡CSS徽章
  - 弹窗：全屏模糊背景 + CSS大徽章 + 极简×关闭按钮
  - 暗色主题完整适配
  - 构建验证通过 ✅


### #004 「我的-通知」页面构建

- **提出时间**: 2026年2月27日 
- **提出人**: 用户
- **优先级**: P1
- **状态**: ✅ 已完成
- **问题描述**: 
  - 按照设计稿，开始重新构建「我的-通知」页面
  - 打通「我的-通知」页面的前后端，实现功能的端到端落地

- **解决情况（2026年2月27日 — 全部完成）**:
  - **三个子Tab完整实现**:
    - **系统通知**: 绿色圆点指示器 + 标题/内容 + "新"红标 + 绿色胶囊操作按钮("→ 去填写") + 时间 + 删除区域
    - **@我的**: 用户头像 + 姓名/时间/组织 + 评论正文 + 绿色气泡引用原文("我：...") + 回复按钮
    - **我的评论**: 活动卡片(分类+标题+描述+星级评分) + 数据统计(♥点赞/◎评论/✦收藏/↗分享) + 绿色气泡我的评论 + 三点菜单(修改/删除)
  - **前后端连接**:
    - 创建 `services/notifications.ts` 前端服务层
    - 系统通知: 调用 `GET /notifications/me`，后端事件自动映射为UI显示文案
    - @我的 / 我的评论: 预留 API 调用接口，当前 mock 数据兜底
    - 事件映射: SIGNUP_SUBMITTED→报名成功 / SIGNUP_APPROVED→审批通过 / SIGNUP_REJECTED→被拒绝 / SIGNUP_REMINDER→活动提醒 / CHECKIN_REMINDER→签到提醒
  - **交互功能**: 清空消息确认弹窗 / 删除评论确认 / 修改评论跳转 / 回复跳转 / 分页
  - **类型系统**: 新增 `MentionItem` + `MyCommentItem` 类型定义
  - **暗色主题**: 完整适配
  - 构建验证通过 ✅

- **问题描述（2026年2月27日 14:29）**: 
  页面设计与设计稿件不符合
  - 需要有一键清空消息的按钮（也就是说将最新最新的消息标记为已读）
  - 点击批量删除的按钮，需要可以进行批量删除的选择
  - 缺少分页机制
  - 单个消息的删除，是往左边进行滑动删除
  - 清空消息提醒的弹窗是在页面底部（仔细查看设计稿件）
  - 「我的评论」的页面，点赞、评论、分享、收藏的功能都没有打通
  - 我的评论」的页面，三点按钮的「修改」与「删除」的小弹窗的样式与设计稿件不符合（这个样式与「我的-活动列表」中的「修改报名信息」的小弹窗样式是一样的）
  所有的功能都需要前后端打通、端到端的落实

- **修复记录（2026年2月27日 15:00）**:
  **全部修复完成**，7 项问题逐一落实，端到端打通：

  **1. 一键清空消息 / 全部已读**
  - 工具栏左侧增加绿色圆形 ✓ 图标按钮，点击弹出底部弹窗确认清空
  - 后端新增 `PUT /notifications/me/read-all` 标记已读接口
  - 后端新增 `DELETE /notifications/me` 清空所有通知接口

  **2. 批量删除选择模式**
  - 点击"批量删除"进入选择模式，每条消息左侧出现复选框
  - 工具栏切换为"取消 | 已选 X 项 | 删除"操作栏
  - 后端新增 `POST /notifications/me/batch-delete` 批量删除接口

  **3. 左滑删除**
  - 实现 `onTouchStart/onTouchMove` 手势识别
  - 左滑超过 40px 露出 72px 红色删除区域，右滑收回
  - 后端新增 `DELETE /notifications/{id}` 单条删除接口

  **4. 底部弹窗**
  - 替换 `Taro.showModal` 为自定义底部弹出式弹窗（BottomSheet）
  - 半透明遮罩 + 白色圆角底部面板 + 取消/确定双按钮
  - 支持 `safe-area-inset-bottom` 适配全面屏
  - 清空消息、删除评论均使用统一底部弹窗

  **5. 我的评论: 互动操作打通后端**
  - ♥ 点赞 → 调用 `toggleLike(activityId)` 接口
  - ◎ 评论 → 跳转到活动评论页
  - ✦ 收藏 → 调用 `toggleFavorite(activityId)` 接口
  - ↗ 分享 → 调用 `recordShare(activityId)` 接口
  - 删除评论 → 调用 `deleteComment(commentId)` 接口

  **6. 三点菜单样式对标设计稿**
  - 下拉菜单样式完全对齐 ActivitiesTab `.row-menu-panel`
  - 白色圆角 16px、阴影、内边距 8px
  - 修改项: #f3f5f2 背景、#24432e 文字
  - 删除项: rgba(239,95,101,0.08) 背景、#ef5f65 文字

  **7. 后端 API 新增**
  - `NotificationStatus.READ` 枚举值
  - `NotificationRepository` 新增 `delete_one`, `delete_batch`, `delete_all_for_user`, `mark_all_read`
  - `NotificationService` 新增 `delete_notification`, `batch_delete`, `delete_all_for_user`, `mark_all_read`
  - 4 个新 API 端点全部有用户鉴权

  **修改文件清单**:
  - `backend/app/models/enums.py` — 新增 READ 状态
  - `backend/app/repositories/notifications.py` — 4 个新方法
  - `backend/app/services/notifications.py` — 4 个新方法
  - `backend/app/api/v1/endpoints/notifications.py` — 4 个新端点
  - `backend/app/schemas/notification.py` — BatchDeleteRequest
  - `frontend/app/src/services/notifications.ts` — 3 个新服务函数
  - `frontend/app/src/pages/profile/types.ts` — MyCommentItem 增加 is_liked/is_favorited
  - `frontend/app/src/pages/profile/components/NotificationsTab.tsx` — 完全重构
  - `frontend/app/src/pages/profile/index.scss` — 大量样式更新
  - 构建验证通过 ✅ (1.0MB)


- **问题描述（2026年2月27日 14:52）**: 
  页面设计与设计稿件不符合
  - 右上角只需要有三个按钮，一键已读的按钮（可以是扫帚状），批量删除的按钮，全部清空的按钮（所有按钮不需要有文字）
  - 去掉右上角的绿色勾选按钮（为什么要把按钮放在这个地方？不正确！！！）
  - 底部的胶囊导航岛在全部清空和批量删除的弹窗出现时，不应该显示出来！！！！
  - 单个消息的删除按钮，太丑了，需要绘制高级简约的按钮（后期我会准备所有的按钮图标）
  - 「我的评论」的页面，点赞、评论、分享、收藏的功能全部失效，显示操作失败

- **修复记录（2026年2月27日 15:20）**:
  **5项全部修复**：

  **1. 工具栏按钮**
  - 移除左侧绿色✓按钮
  - 右侧改为3个纯图标按钮（无文字）：⊘已读 / ☰批量删除 / ⌫全部清空
  - 批量模式下切换为 "取消 | 已选X项 | 删除" 操作栏

  **2. 胶囊导航岛隐藏**
  - NotificationsTab 新增 `onModalVisibleChange` 回调
  - 底部弹窗出现时通知父组件隐藏 CustomTabBar
  - 弹窗关闭时恢复显示

  **3. 左滑删除按钮美化**
  - 替换文字符号为纯CSS绘制的极简垃圾桶图标
  - 包含盖子、桶体、内部竖线细节

  **4. 互动操作失败修复**
  - **根因**: 引入了 `engagements.ts` 的 `toggleLike/toggleFavorite/recordShare`，该文件直接调用真实API无mock支持
  - **修复**: 改为引入 `engagement.ts` 的 `likeActivity/unlikeActivity/favoriteActivity/unfavoriteActivity/shareActivity`，这些函数支持 `CONFIG.USE_MOCK` 模式

  **修改文件**: NotificationsTab.tsx, index.tsx, index.scss
  - 构建验证通过 ✅ (1.0MB)


- **问题描述（2026年2月27日 15:25）**: 
  - 除了「系统通知」的页面，「@我的」和「我的评论」页面都不需要左上角的三个图标
  - 所有页面都没有做分页机制，分页器的设计要高级美观
  - 暗黑模式下，系统通知的页面，怎么全部都显示滑动删除的图标？进行修改
  - 完成上述修改后，同步更新所有文档，提交GitHub
  - 再根据设计稿进行「我的」设置页面的重构

- **修复记录（2026年2月27日 15:40）**:
  **3项全部修复（前3点）**：

  **1. 工具栏图标仅系统通知tab显示**
  - 用 `notifyTab === 'system'` 条件包裹工具栏整体
  - 切换到「@我的」「我的评论」时工具栏自动隐藏

  **2. 分页器全面重设计**
  - 箭头按钮改为CSS绘制的V型箭头 + 圆角背景
  - 中间使用 pill-track 容器包裹页码
  - 当前页为绿色圆角胶囊高亮 + 投影
  - 支持省略号（超过5页时显示 `···`）
  - 底部增加 `当前页/总页数` 文字提示
  - 暗色主题完整适配（绿色高亮）

  **3. 暗黑模式删除图标bug**
  - **根因**: 卡片 `.nt-card` 和 `.nt-card-body` 在暗色主题下使用 `rgba(255,255,255,0.04)` 半透明背景，无法遮盖底层红色删除区域
  - **修复**: 改为不透明色 `#1e2228`，完全覆盖 `.nt-delete-area`

  **修改文件**: NotificationsTab.tsx, index.scss


### #005 「我的-设置」页面构建

- **提出时间**: 2026年2月27日 
- **提出人**: 用户
- **优先级**: P1
- **状态**: 🟡 处理中
- **问题描述（2026年2月27日 16:12）**: 
  - 整个页面的列表区域，字体和图标尺寸可以缩小一点
  - 然后开始调用sketch重新构建「个人简介」、「我的缴费」、「我的发票抬头」这三个页面的设计



- **问题描述（2026年2月27日 16:29）**: 
  - 个人简介页面的表单框，不要有白色的背景，表单的线框保持绿色的主色调
  - 个人简介页面，左上角返回键已经贴近屏幕顶部了，需要往下移动，保持跟微信右上角胶囊按钮保持同一水平线
  - 表单的字段修改需要前后端全部打通
  - 头像的修改也需要进行打通

- **问题描述（2026年2月27日 16:40）**: 
  - 个人简介页面的表单框，不要有白色的背景，表单的线框保持绿色的主色调
  - 表单字段依旧没有打通，我修改姓名为“赵虎”，但是依旧显示“张三”
  - 线框发光的效果再加强一些
  - 我的缴费页面，严格按照设计稿进行，「已缴费」的标签在右下角（看设计图），而且往左滑动的红色删除背景，在没有滑动的时候，有一些红色的背景颜色显露出来了，需要调整
  - 我的缴费页面，所有的功能都没有打通，「排列」、「时间」、「类型」的功能都没有生效，「论坛」、「峰会」这些小标签中的文字在标签方块中没有居中对齐
  - 我的缴费页面，点击查看详情应该出现缴费详情的弹窗

- **修复记录（2026年2月27日 17:10）**:
  
  ### 一、个人简介页面修复
  1. **表单字段持久化打通**: `user.ts` 中 `fetchCurrentUser` 和 `updateUser` 在 Mock 模式下通过 `Taro.getStorageSync/setStorageSync('mock_user_overrides')` 实现数据持久化，修改姓名后再次进入页面可保持修改后的值
  2. **线框发光效果加强**: `.pe-input-wrap:focus-within` 的 `box-shadow` 从单层 3px 增强为双层 `0 0 0 4px rgba(45,90,61,0.15), 0 0 12px rgba(45,90,61,0.1)`，暗色模式同步增强
  
  ### 二、我的缴费页面全面重构
  1. **「已缴费」标签右下角定位**: 使用 `position: absolute; right: 0; bottom: 0;` 配合 `border-radius: 8px 0 16px 0` 实现右下角贴边标签效果
  2. **红色删除背景透出修复**: 卡片体 `z-index: 2`、删除区域 `z-index: 1`，确保卡片完全遮盖删除区域
  3. **标签文字居中**: `.mp-tag` 添加 `display: flex; align-items: center; justify-content: center;` + `line-height: 1.6`
  4. **排列/类型/时间筛选功能打通**: 三个下拉菜单支持排序(默认/金额升降序)、类型筛选(全部/论坛/峰会/研讨会/培训)、时间筛选(全部/7天/月/年)
  5. **查看详情弹窗**: 点击弹出居中卡片弹窗，含活动封面+标题+日期、缴费人/时间、费用/订单号/流水号、缴费凭证上传区、确定按钮，遮罩支持高斯模糊
  6. **返回按钮改为圆形**: 与个人简介页面统一风格
  7. **暗色主题全面适配**: 弹窗、下拉菜单、批量栏等新增元素均包含暗色样式
  
  **涉及文件**: `user.ts`、`profile-edit/index.scss`、`my-payments/index.tsx`、`my-payments/index.scss`



- **问题描述（2026年2月27日 17:04）**: 
  - 线框发光，不要形成阴影！！！目前的代码把发光写成了阴影，需要是柔和的散光，不是阴影！！
  - 圆圈的返回键触及到了屏幕顶部！！！！！需要往下移动！！！！！！
  - 缴费列表的页面整体往下移动，触及屏幕顶部了！！！！
  - 缴费列表的每个列表框，不要白色背景，就只要绿色的线框
  - 红色删除的背景，依旧会显露出一些红色
  - 缴费详情的弹窗，内容区域，左边的文字与右边的文字间距太远，导致右边的文字被弹窗边界截断
  - 缴费详情的弹窗，不需要左上角的返回键
  - 缴费详情的弹窗，是覆盖整个页面的灰色毛玻璃（调用sketch，仔细查看毛玻璃的样式参数），也就是相当于把内容直接放在高斯模糊的背景上

- **修复记录（2026年2月27日 17:20）**:
  1. **线框散光效果**: `box-shadow` 从 `0 0 0 4px`(实心环) 改为 `0 0 10px + 0 0 20px` 纯扩散光晕，无偏移无扩展，呈现柔和散光而非阴影
  2. **返回键下移**: `.mp-back` 的 `padding-top` 从 `+6px` 增大为 `+10px`，远离屏幕顶部
  3. **缴费列表页面下移**: 滚动区高度调整为 `calc(100vh - 180px)`，整体内容下移
  4. **卡片去白色背景**: `.mp-card-body` 的 `background` 从 `#fff` 改为与页面背景色一致的 `#f5f6f3`(浅色)/ `#141618`(暗色)，`border` 改为绿色线框 `1.5px solid rgba(45,90,61,0.25)`
  5. **红色删除背景彻底隐藏**: 卡片体使用与页面完全一致的不透明背景色覆盖，红色区域在未滑动时完全不可见
  6. **弹窗文字间距修复**: `.mp-detail-row-value` 移除 `max-width: 55%` 限制，改用 `flex: 1; min-width: 0` 自适应宽度，行间距改用 `gap: 12px` 确保紧凑
  7. **弹窗去除返回键**: 删除 `.mp-detail-back` 相关 JSX 和 CSS
  8. **全屏毛玻璃弹窗**: 弹窗从"居中白色卡片"改为全屏覆盖式，`background: rgba(245,246,243,0.75)` + `backdrop-filter: blur(20px) saturate(1.2)`，内容直接铺在磨砂背景上，无白色容器；暗色模式使用 `rgba(20,22,24,0.8)`
  
  **涉及文件**: `profile-edit/index.scss`、`my-payments/index.tsx`、`my-payments/index.scss`


- **问题描述（2026年2月27日 17:22）**: 
  - 「确定」的按钮与「缴费凭证」的上传的方框拉近距离
  - 毛玻璃的透明度需要提高！！！看设计稿的截图
  - 缴费列表需要需要分页机制
  - 「批量选择」用图标按钮代替


- **修复记录（2026年2月27日 17:35）**:
  1. **确定按钮与缴费凭证拉近**: 上传区域 `margin-bottom` 从 16px 改为 0，footer `padding` 从 12px/20px 缩减为 10px/16px
  2. **毛玻璃透明度提高**: `background` 透明度从 0.55 降至 0.35，`blur` 从 30px 增至 40px，`saturate` 从 1.4 增至 1.6，底层内容更清晰可见
  3. **分页机制**: 每页显示 5 条，底部圆点指示器 + 页码信息，筛选条件变化时自动重置到第 1 页
  4. **批量选择改图标**: 文字"批量选择"替换为双方块 CSS 图标，激活时填充绿色
  
  **涉及文件**: `my-payments/index.tsx`、`my-payments/index.scss`


- **问题描述（2026年2月28日 10:20）**: 
  - 透明度还要提高
  - 整个内容区域还需要整体往下移动，目前比较贴近屏幕顶部
  - 「缴费时间」下面的实心横线需要改成虚线


- **问题描述（2026年2月28日 14:23）**: 
  - 缴费列表需要分页机制
  - 然后完善「我的发票抬头」页面
    - 发票列表需要分页机制
    - 「添加发票抬头」，有「个人」和「单位」的信息填写，「单位」的表单字段需要调用sketch仔细查看设计图

- **修复记录（2026年2月28日 14:50）**:
  1. **缴费列表分页**: 已在之前版本完成（PAGE_SIZE=5，圆点指示器+页码）
  2. **发票抬头页面全面重构**: 通过 Sketch MCP 读取4个设计稿画板精确参数
  3. **发票列表分页**: 新增 PAGE_SIZE=4 分页机制，圆点指示器 + 页码信息
  4. **列表卡片对标**: border `#183d1e` 0.5px, radius 10, 头像 20px 圆形, 名称 sz:11, 类型 sz:8 `#808080`, QR码图标, 分隔线 `#e5e5e5`
  5. **操作按钮对标**: 编辑(边框`#183d1e`), 复制内容(bg`#0278f5`), 删除(bg`#e71d36`) — 均 sz:8 pill 样式
  6. **添加发票抬头弹窗**: Bottom Sheet 设计, handle bar `#a6a6a6`, 标题 sz:13
  7. **Segmented Control**: bg `#f6f8fe` radius 15, active tab `#fefefe` radius 8
  8. **个人表单**: 名称字段, label sz:14 `#78828a`, placeholder sz:12 `#808080`
  9. **单位表单 6 个字段**: 名称(必填)/税号/单位地址/电话/开户银行/银行账号, 全部来自 Sketch 设计稿
  10. **保存按钮**: inactive `#e5e5e5`, active `#183d1e`, radius 5, 48x20
  11. **加载动画**: Toast overlay bg `#4c4c4c` radius 12, spinner + "加载中" sz:17
  12. **滑动删除**: 左滑显示红色删除区域
  13. **暗色主题**: 完整适配
  
  **涉及文件**: `invoice-headers/index.tsx`、`invoice-headers/index.scss`

- **修复记录（2026年2月28日 10:30）**:
  1. **Sketch MCP 读取设计稿**: 通过 Sketch MCP 直接读取 `小程序端设计.sketch` 的「我的-缴费信息-缴费详情」画板，提取所有精确参数
  2. **毛玻璃透明度再次提高**: `background` 透明度从 0.45 降至 0.2（`rgba(248,248,246,0.2)`），底部列表更清晰透过
  3. **内容区域整体下移**: `paddingTop` 从 `topPad+20` 增至 `topPad+56`，远离屏幕顶部
  4. **分隔线改为虚线**: `border-top` 从 `solid` 改为 `dashed`
  5. **头部边框卡片**: 新增 `.mp-detail-header-card`，仅边框包裹图片+标题区域（`#e3e7ec` 1px, radius 14），无白色卡片
  6. **全部颜色/字号精确对标 Sketch**: 区块标题 `#9ca4ab`（非绿色），缴费截图标题 `#183d1e` 9px，订单号/流水号 `#383838` 10px，确定按钮 `#000000` radius 5 / 126x27
  7. **上传区域对标**: 边框 `#000000` 0.5px dashed，填充 `#e5e5e5`，文字 `#8c8c8c` 8px



- **问题描述（2026年2月28日 14:41）**: 
  - 「我的缴费」的页面需要分页机制！！！！目前没有分页
  - 然后完善「我的发票抬头」页面
    - 需要去掉「删除」的按钮
    - 左滑删除的UI样式出现了排版错误，你可以参照「缴费列表」的左滑删除样式进行重构
    - 「编辑」和「复制」的按钮文字，在按钮框中没有居中，需要修改
    - 点击「编辑」按钮需要出现对应的发票编辑页面，理解吗？比如，如果是个人的发票，就出现对应的个人信息的编辑，如果是单位的发票，就出现对应的单位信息的编辑（这个在sketch中没有设计，需要你现在进行设计）

  
  **涉及文件**: `my-payments/index.tsx`、`invoice-headers/index.tsx`、`invoice-headers/index.scss`

  **修复记录（2026年2月28日 15:05）** ✅ COMPLETED
  1. **缴费列表分页**: 原有分页逻辑已存在（PAGE_SIZE=5），但 MOCK 数据仅 4 条无法触发分页显示。增加 4 条 mock 数据（总计 8 条）确保分页功能正常展示
  2. **发票抬头 — 去掉「删除」按钮**: 卡片底部操作区只保留「编辑」和「复制内容」两个按钮，删除功能仅通过左滑触发
  3. **发票抬头 — 左滑删除 UI 重构**: 完全参照缴费列表（`mp-delete-area`）样式重写：
     - 删除区宽度 `72px`、背景 `#ef4444`、圆角 `0 10px 10px 0`
     - 垃圾桶图标与缴费列表完全一致（lid + body + 两条竖线装饰）
     - 按压态 `#dc2626`
  4. **编辑/复制按钮文字居中**: 按钮改用 `display: flex; align-items: center; justify-content: center;`，固定 `height: 22px`，文字 `line-height: 22px`，确保文字在按钮框中完全居中
  5. **点击编辑弹出编辑表单**: 新增 `sheetMode`（add/edit）和 `editingId` 状态管理：
     - 点击「编辑」自动读取该发票抬头数据填入表单
     - 个人发票只显示名称字段，单位发票显示全部 6 个字段
     - 编辑模式下不显示分段选择器（类型不可改），标题变为「编辑发票抬头」
     - 保存后原地更新数据并提示「保存成功」

- **问题描述（2026年2月28日 15:30）**: 
  - 所有列表页面需要实现后端分页逻辑（替代纯客户端分页）
  - 发票抬头「复制」按钮需要走后端接口，且复制完整发票文本信息

  **涉及文件**: 
  - 后端新增: `payment.py` (model/schema/repo/service/endpoint), `invoice_header.py` (model/schema/repo/service/endpoint)
  - 前端新增: `services/payments.ts`, `services/invoice-headers.ts`
  - 前端修改: `my-payments/index.tsx`, `invoice-headers/index.tsx`

  **修复记录（2026年2月28日 16:00）** ✅ COMPLETED

  **后端全栈实现:**
  1. **Payment 模型**: 新建 `payments` 表，包含 user_id, activity_id, activity_title, amount, category, status, pay_date, cover_url, date_range, time_range, payer, order_no, transaction_no, payment_screenshot 字段
  2. **InvoiceHeader 模型**: 新建 `invoice_headers` 表，包含 user_id, name, type, tax_number, address, phone, bank_name, bank_account 字段
  3. **后端分页 API**:
     - `GET /api/v1/payments` — 分页查询缴费记录，支持 page/per_page/status/category 筛选，返回 `{ items, total, page, per_page, total_pages }`
     - `GET /api/v1/invoice-headers` — 分页查询发票抬头，支持 page/per_page/type 筛选
  4. **发票复制接口**: `GET /api/v1/invoice-headers/{id}/copy-text` — 返回完整文本（名称+税号+地址+电话+开户银行+银行账号），前端直接写入剪贴板
  5. **完整 CRUD**: 两个模块都实现了 GET/POST/PATCH/DELETE，缴费还支持 bulk-delete
  6. **架构层级**: Model → Repository → Service → Endpoint，符合项目现有架构模式
  7. **路由注册**: `/api/v1/payments` + `/api/v1/invoice-headers`

  **前端对接:**
  1. **服务层**: 新建 `services/payments.ts` 和 `services/invoice-headers.ts`，封装所有 API 调用
  2. **缴费列表**: 移除 MOCK_PAYMENTS，改为 `loadPayments(page)` 调用后端 API，分页/删除/批量删除都走接口
  3. **发票抬头**: 移除 MOCK_HEADERS，改为 `loadHeaders(page)` 调用后端 API，添加/编辑/删除/复制都走接口
  4. **复制功能**: 优先调用 `GET /invoice-headers/{id}/copy-text` 获取完整文本，API 不可用时前端兜底拼接

---

## ⚪ 已关闭

> 本周暂无已关闭的问题

---

## 📊 本周统计

| 指标 | 数值 |
|------|------|
| 总问题数 | 9 |
| 处理中 | 0 |
| 待处理 | 0 |
| 已完成 | 9 |
| 已关闭 | 0 |

---

## 🔗 相关文档

- [每日工作报告](../每日工作报告.md) - 每日工作记录
- [项目进度文档](../1-项目进度文档.md) - 整体进度
- [下一步规划文档](../16-下一步规划文档.md) - 下一步计划

---

**归档提醒**: 本周日（3月1日）或下周一（3月2日）将本周问题归档并切换到下周文档
